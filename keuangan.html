<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Saldo Rekening Bersama</title>

<script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100 flex items-center justify-center min-h-screen">

<div class="bg-white shadow-xl rounded-xl p-8 text-center">
  <h2 class="text-xl font-semibold mb-2">Saldo Rekening Bersama</h2>
  <p id="saldo" class="text-4xl font-bold text-green-600">Memuat...</p>
</div>

<script>
const sheetId = "1TNhwC9WaZza1MXvIKqUYjk4PgliSDKfRQgh6WfV4-o0";
const sheetName = "SALDO";

fetch(`https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:csv&sheet=${sheetName}`)
.then(r => r.text())
.then(t => {

  let rows = t.trim().split("\n");

  let saldo = 0;

  // ambil dari bawah (baris terakhir)
  for(let i = rows.length-1; i >= 1; i--){
    let cols = rows[i].split(",");
    let v = cols[4]; // kolom E

    if(v){
      saldo = v.replace(/[^0-9]/g,"");
      break;
    }
  }

  document.getElementById("saldo").innerText =
    "Rp " + Number(saldo).toLocaleString("id-ID");

});
</script>

</body>
</html>