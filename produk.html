<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Produk DPD TESPOIN Majalengka</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100 p-4">

<div class="max-w-3xl mx-auto bg-white rounded shadow p-4">

<h1 class="text-xl font-bold text-center mb-4">Produk DPD TESPOIN Majalengka</h1>

<!-- PRODUK PATEN -->
<h2 class="text-lg font-semibold mt-4 mb-2 text-green-700">ğŸŸ¢ Produk DPD (Tetap)</h2>
<div id="produkTetap" class="space-y-4">

<!-- CONTOH PRODUK PATEN -->
<div class="bg-gray-50 rounded shadow p-4">
<img src="unlocktool.jpg" class="w-full rounded mb-2">
<h3 class="font-bold">Unlock Tool</h3>
<p>Rental / Sewa Harian</p>
<p class="text-green-600 font-semibold">Rp 10.000</p>
<a href="https://wa.me/6282319264646?text=Saya%20mau%20sewa%20Unlock%20Tool"
class="block bg-green-600 text-white text-center p-2 rounded mt-2">
WhatsApp Admin
</a>
</div>

</div>

<!-- PRODUK MEMBER -->
<h2 class="text-lg font-semibold mt-6 mb-2 text-orange-600">ğŸŸ¡ Produk Member (7 Hari)</h2>
<a href="https://forms.gle/BHn6ijimuK887K8y7" target="_blank" class="upload-btn">
â• Upload Produk Anda
</a>
<div id="produkMember" class="space-y-4"></div>

<a href="index.html" class="block text-center text-blue-600 mt-6">â† Kembali ke Beranda</a>

</div>
<script>
const sheetUrl = "https://docs.google.com/spreadsheets/d/19AfachAS9ZyNuut61RB1wqyI_AI6BsmNT1SIWhmSIn8/export?format=csv&gid=833555455";

fetch(sheetUrl)
.then(r=>r.text())
.then(t=>{
  const rows=t.trim().split(/\r?\n/).slice(1);
  const box=document.getElementById("produkMember");

  rows.forEach(r=>{
  const c=r.split(/,(?=(?:[^"]*"[^"]*")*[^"]*$)/);

const tgl=c[0].trim();
const d=tgl.split(" ");
const ymd=d[0].split("/");
const hms=d[1].split(":");

const waktu=new Date(
  ymd[2], ymd[1]-1, ymd[0],
  hms[0], hms[1], hms[2]
);
    const now=new Date();
    const hari=(now-waktu)/86400000;

    if(hari<=7){

const nama = c[1];
const des  = c[2];
const harga = c[6]; // ambil dari G (harga_fix)
const wa = c[7];    // ambil dari H (wa_fix)
let img = c[8];     // ambil dari I (foto_fix) 
if(img.includes("drive.google")){
  const id = img.match(/[-\w]{25,}/);
  if(id){
    img = "https://drive.google.com/uc?export=view&id=" + id[0];
  }
}

      box.innerHTML+=`
      <div class="border rounded p-3">
        <img src="${img}" class="w-full rounded mb-2">
        <b>${nama}</b>
        <p>${des}</p>
        <p class="text-green-600">Rp ${harga}</p>
        <a href="https://wa.me/62${wa.substring(1)}" target="_blank"
           class="block bg-green-600 text-white text-center mt-2 p-2 rounded">
           WhatsApp Penjual
        </a>
      </div>`;
}
});
});
</script>

</body>
</html>